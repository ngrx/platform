# Using Entity Adapter with Feature Creator

This recipe demonstrates how to combine [entity adapter](/guide/entity/adapter#entity-adapter) (selectors) within [extraSelectors](/guide/store/feature-creators#providing-extra-selectors).

As an example, let's look at some code from a User state management feature.

Start by defining the state for the `User` feature.

<code-example header="users.state.ts">

import { EntityState, createEntityAdapter } from '@ngrx/entity';
import { User } from './user.model';

export interface State extends EntityState&lt;User&lt; {
  selectedUserId: string | null;
}

const adapter = createEntityAdapter&lt;User&lt;();

export const initialState: State = adapter.getInitialState({
  selectedUserId: null,
});

</code-example>

Then, we define the `User` actions: `addUser` and `selectUser`.

<code-example header="user-list-page.actions.ts">


import { createActionGroup, props } from '@ngrx/store';
import { User } from './user.model';

export const UserListPageActions = createActionGroup({
  source: 'User List Page',
  events: {
    addUser: props&lt;{ user: User }&gt;(),
    selectUser: props&lt;{ userId: string }&gt;(),
  },
});

</code-example>

Then use the `createReducer` function to create a reducer for the `User` feature.

<code-example header="users.state.ts">

import { createReducer, on } from '@ngrx/store';
import { UserListPageActions } from './user-list-page.actions';

const reducer = createReducer(
  initialState,
  on(UserListPageActions.addUser, (state, { user }) =>
    adapter.addOne(user, state)
  ),
  on(UserListPageActions.selectUser, (state, { userId }) => ({
    ...state,
    selectedUserId: userId,
  }))
);

</code-example>

Then create the `User` feature using the `createFeature` function.
This generates all the basic selectors automatically, and we can specify extra selectors using the `extraSelectors` option.

<code-example header="users.state.ts">

import { createFeature, createSelector } from '@ngrx/store';

export const usersFeature = createFeature({
  name: 'users',
  reducer,
  extraSelectors: ({ selectUsersState, selectEntities, selectSelectedUserId }) => ({
    ...adapter.getSelectors(selectUsersState),
    selectIsUserSelected: createSelector(
      selectSelectedUserId,
      (selectedId) => selectedId !== null
    ),
    selectSelectedUser: createSelector(
      selectSelectedUserId,
      selectEntities,
      (selectedId, entities) => selectedId ? entities[selectedId] : null
    ),
  }),
});

</code-example>

To use the selector within a component, `inject` the `Store` and select the data from the state using the selectors generated by the `createFeature` function.

<code-example header="user-list.component.ts">

import { usersFeature } from './users.state';

@Component({ /* ... */ })
export class UserListComponent{
  private readonly store = inject(Store);
  
  readonly users$ = this.store.select(usersFeature.selectAll);
  readonly isUserSelected$ = this.store.select(usersFeature.selectIsUserSelected);
  readonly selectedUser$ = this.store.select(usersFeature.selectSelectedUser);
}

</code-example>

